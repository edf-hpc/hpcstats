

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Users Package &mdash; HPCStats 1.6.1 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="../genindex.html"/>
        <link rel="search" title="Search" href="../search.html"/>
    <link rel="top" title="HPCStats 1.6.1 documentation" href="../index.html"/>
        <link rel="up" title="Importer Package" href="HPCStats.Importer.html"/>
        <link rel="next" title="Log Package" href="HPCStats.Log.html"/>
        <link rel="prev" title="Projects Package" href="HPCStats.Importer.Projects.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> HPCStats
          

          
          </a>

          
            
            
              <div class="version">
                1.6.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../architecture.html">Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../configuration.html">Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../usage.html">Usage guide</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="modules.html">API reference</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="HPCStats.html">HPCStats Package</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="HPCStats.html#module-HPCStats.Exceptions"><code class="docutils literal"><span class="pre">Exceptions</span></code> Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="HPCStats.html#module-HPCStats.Utils"><code class="docutils literal"><span class="pre">Utils</span></code> Module</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="HPCStats.html#subpackages">Subpackages</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="HPCStats.CLI.html">CLI Package</a></li>
<li class="toctree-l4"><a class="reference internal" href="HPCStats.Conf.html">Conf Package</a></li>
<li class="toctree-l4"><a class="reference internal" href="HPCStats.DB.html">DB Package</a></li>
<li class="toctree-l4"><a class="reference internal" href="HPCStats.Errors.html">Errors Package</a></li>
<li class="toctree-l4"><a class="reference internal" href="HPCStats.Finder.html">Finder Package</a></li>
<li class="toctree-l4 current"><a class="reference internal" href="HPCStats.Importer.html">Importer Package</a></li>
<li class="toctree-l4"><a class="reference internal" href="HPCStats.Log.html">Log Package</a></li>
<li class="toctree-l4"><a class="reference internal" href="HPCStats.Model.html">Model Package</a></li>
<li class="toctree-l4"><a class="reference internal" href="HPCStats.Tests.html">Tests Package</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../index.html">HPCStats</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          

 



<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html">Docs</a> &raquo;</li>
      
          <li><a href="modules.html">API reference</a> &raquo;</li>
      
          <li><a href="HPCStats.html">HPCStats Package</a> &raquo;</li>
      
          <li><a href="HPCStats.Importer.html">Importer Package</a> &raquo;</li>
      
    <li>Users Package</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/api/HPCStats.Importer.Users.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="users-package">
<h1>Users Package<a class="headerlink" href="#users-package" title="Permalink to this headline">¶</a></h1>
<div class="section" id="id1">
<h2><code class="xref py py-mod docutils literal"><span class="pre">Users</span></code> Package<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h2>
<span class="target" id="module-HPCStats.Importer.Users"></span><p>This package contains all User importers.</p>
</div>
<div class="section" id="module-HPCStats.Importer.Users.UserImporter">
<span id="userimporter-module"></span><h2><code class="xref py py-mod docutils literal"><span class="pre">UserImporter</span></code> Module<a class="headerlink" href="#module-HPCStats.Importer.Users.UserImporter" title="Permalink to this headline">¶</a></h2>
<p>This module contains the base class for all User importers.</p>
<dl class="class">
<dt id="HPCStats.Importer.Users.UserImporter.UserImporter">
<em class="property">class </em><code class="descclassname">HPCStats.Importer.Users.UserImporter.</code><code class="descname">UserImporter</code><span class="sig-paren">(</span><em>app</em>, <em>db</em>, <em>config</em>, <em>cluster</em><span class="sig-paren">)</span><a class="headerlink" href="#HPCStats.Importer.Users.UserImporter.UserImporter" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="HPCStats.Importer.html#HPCStats.Importer.Importer.Importer" title="HPCStats.Importer.Importer.Importer"><code class="xref py py-class docutils literal"><span class="pre">HPCStats.Importer.Importer.Importer</span></code></a></p>
<p>This is the base class common to all HPCStats User importers.
It defines a common set of attributes and generic methods.</p>
<dl class="method">
<dt id="HPCStats.Importer.Users.UserImporter.UserImporter.find_account">
<code class="descname">find_account</code><span class="sig-paren">(</span><em>search</em><span class="sig-paren">)</span><a class="headerlink" href="#HPCStats.Importer.Users.UserImporter.UserImporter.find_account" title="Permalink to this definition">¶</a></dt>
<dd><p>Search for an Account over the list of Accounts loaded by importer
in self.accounts attribute. Returns None if not found.</p>
</dd></dl>

<dl class="method">
<dt id="HPCStats.Importer.Users.UserImporter.UserImporter.find_user">
<code class="descname">find_user</code><span class="sig-paren">(</span><em>search</em><span class="sig-paren">)</span><a class="headerlink" href="#HPCStats.Importer.Users.UserImporter.UserImporter.find_user" title="Permalink to this definition">¶</a></dt>
<dd><p>Search for a User over the list of Users loaded by importer
in self.users attribute. Returns None if not found.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-HPCStats.Importer.Users.UserImporterFactory">
<span id="userimporterfactory-module"></span><h2><code class="xref py py-mod docutils literal"><span class="pre">UserImporterFactory</span></code> Module<a class="headerlink" href="#module-HPCStats.Importer.Users.UserImporterFactory" title="Permalink to this headline">¶</a></h2>
<p>This module contains the factory design pattern class that builds the
appropriate UserImporter depending on what is specified in configuration.</p>
<dl class="class">
<dt id="HPCStats.Importer.Users.UserImporterFactory.UserImporterFactory">
<em class="property">class </em><code class="descclassname">HPCStats.Importer.Users.UserImporterFactory.</code><code class="descname">UserImporterFactory</code><a class="headerlink" href="#HPCStats.Importer.Users.UserImporterFactory.UserImporterFactory" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<p>This class simply delivers the factory() static method, there is not
point to instanciate it with an object.</p>
<dl class="staticmethod">
<dt id="HPCStats.Importer.Users.UserImporterFactory.UserImporterFactory.factory">
<em class="property">static </em><code class="descname">factory</code><span class="sig-paren">(</span><em>app</em>, <em>db</em>, <em>config</em>, <em>cluster</em><span class="sig-paren">)</span><a class="headerlink" href="#HPCStats.Importer.Users.UserImporterFactory.UserImporterFactory.factory" title="Permalink to this definition">¶</a></dt>
<dd><p>This method returns the appropriate UserImporter object depending on
what is specified in configuration. In case of configuration error,
HPCStatsConfigurationException is raised.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-HPCStats.Importer.Users.UserImporterLdap">
<span id="userimporterldap-module"></span><h2><code class="xref py py-mod docutils literal"><span class="pre">UserImporterLdap</span></code> Module<a class="headerlink" href="#module-HPCStats.Importer.Users.UserImporterLdap" title="Permalink to this headline">¶</a></h2>
<p>This module contains the UserImporterLdap class.</p>
<dl class="class">
<dt id="HPCStats.Importer.Users.UserImporterLdap.UserImporterLdap">
<em class="property">class </em><code class="descclassname">HPCStats.Importer.Users.UserImporterLdap.</code><code class="descname">UserImporterLdap</code><span class="sig-paren">(</span><em>app</em>, <em>db</em>, <em>config</em>, <em>cluster</em><span class="sig-paren">)</span><a class="headerlink" href="#HPCStats.Importer.Users.UserImporterLdap.UserImporterLdap" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#HPCStats.Importer.Users.UserImporter.UserImporter" title="HPCStats.Importer.Users.UserImporter.UserImporter"><code class="xref py py-class docutils literal"><span class="pre">HPCStats.Importer.Users.UserImporter.UserImporter</span></code></a></p>
<p>This UserImporter is a bit tricky since it also has to calculate start
and end datetime of users&#8217; Accounts. For this purpose, the load() method
must first get all user accounts that are currently defined w/o end
datetime in database to find out if they have disapeared or not in LDAP
directory. If yes, update the account end datetime with todays date.</p>
<dl class="method">
<dt id="HPCStats.Importer.Users.UserImporterLdap.UserImporterLdap.check">
<code class="descname">check</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#HPCStats.Importer.Users.UserImporterLdap.UserImporterLdap.check" title="Permalink to this definition">¶</a></dt>
<dd><p>Check the LDAP directory is available for connections.</p>
</dd></dl>

<dl class="method">
<dt id="HPCStats.Importer.Users.UserImporterLdap.UserImporterLdap.connect_ldap">
<code class="descname">connect_ldap</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#HPCStats.Importer.Users.UserImporterLdap.UserImporterLdap.connect_ldap" title="Permalink to this definition">¶</a></dt>
<dd><p>Connect to LDAP directory and set ldap_conn attribute accordingly.
Raises HPCStatsSourceError in case of error.</p>
</dd></dl>

<dl class="method">
<dt id="HPCStats.Importer.Users.UserImporterLdap.UserImporterLdap.get_default_new_date">
<code class="descname">get_default_new_date</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#HPCStats.Importer.Users.UserImporterLdap.UserImporterLdap.get_default_new_date" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the date that is used as creation date for new accounts.
If there is no account for this cluster in DB yet, we consider this
is an import from scratch and the creation date is epoch. Else the
creation date is today.</p>
</dd></dl>

<dl class="method">
<dt id="HPCStats.Importer.Users.UserImporterLdap.UserImporterLdap.get_group_members">
<code class="descname">get_group_members</code><span class="sig-paren">(</span><em>group</em><span class="sig-paren">)</span><a class="headerlink" href="#HPCStats.Importer.Users.UserImporterLdap.UserImporterLdap.get_group_members" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the list of (Users,Account) tuples members of a group in LDAP
directory.</p>
</dd></dl>

<dl class="method">
<dt id="HPCStats.Importer.Users.UserImporterLdap.UserImporterLdap.get_user_account_from_login">
<code class="descname">get_user_account_from_login</code><span class="sig-paren">(</span><em>login</em><span class="sig-paren">)</span><a class="headerlink" href="#HPCStats.Importer.Users.UserImporterLdap.UserImporterLdap.get_user_account_from_login" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns (User,Account) objects tuple with information found in LDAP
for the login in parameter. The login in parameter must be
down-cased.</p>
<p>The created account have None creation date and deletion date. It is
up-to update() method to set them well.</p>
<p>When no account could be found in LDAP directory for the login, if
strict_user_membership attribute is True, this function raises an
HPCStatsSourceError exception. If the attribute is False, None is
returned.</p>
</dd></dl>

<dl class="method">
<dt id="HPCStats.Importer.Users.UserImporterLdap.UserImporterLdap.get_user_department">
<code class="descname">get_user_department</code><span class="sig-paren">(</span><em>login</em>, <em>gid</em><span class="sig-paren">)</span><a class="headerlink" href="#HPCStats.Importer.Users.UserImporterLdap.UserImporterLdap.get_user_department" title="Permalink to this definition">¶</a></dt>
<dd><p>Search for the user department based on its group membership. If
unable to compute a department name this way, use the primary group.</p>
</dd></dl>

<dl class="method">
<dt id="HPCStats.Importer.Users.UserImporterLdap.UserImporterLdap.get_user_department_groups_member">
<code class="descname">get_user_department_groups_member</code><span class="sig-paren">(</span><em>login</em><span class="sig-paren">)</span><a class="headerlink" href="#HPCStats.Importer.Users.UserImporterLdap.UserImporterLdap.get_user_department_groups_member" title="Permalink to this definition">¶</a></dt>
<dd><p>Search for user department based on its groups membership.</p>
<p>The login in parameter must be downcased.</p>
</dd></dl>

<dl class="method">
<dt id="HPCStats.Importer.Users.UserImporterLdap.UserImporterLdap.get_user_department_prim_group">
<code class="descname">get_user_department_prim_group</code><span class="sig-paren">(</span><em>login</em>, <em>gid</em><span class="sig-paren">)</span><a class="headerlink" href="#HPCStats.Importer.Users.UserImporterLdap.UserImporterLdap.get_user_department_prim_group" title="Permalink to this definition">¶</a></dt>
<dd><p>Define the user department based on the name of its primary group.</p>
</dd></dl>

<dl class="method">
<dt id="HPCStats.Importer.Users.UserImporterLdap.UserImporterLdap.load">
<code class="descname">load</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#HPCStats.Importer.Users.UserImporterLdap.UserImporterLdap.load" title="Permalink to this definition">¶</a></dt>
<dd><p>Load (User,Account) tuples from both LDAP directoy and DB.</p>
</dd></dl>

<dl class="method">
<dt id="HPCStats.Importer.Users.UserImporterLdap.UserImporterLdap.load_db">
<code class="descname">load_db</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#HPCStats.Importer.Users.UserImporterLdap.UserImporterLdap.load_db" title="Permalink to this definition">¶</a></dt>
<dd><p>Load (User,Account) tuples w/o account deletion date from DB.</p>
</dd></dl>

<dl class="method">
<dt id="HPCStats.Importer.Users.UserImporterLdap.UserImporterLdap.load_groups_alias">
<code class="descname">load_groups_alias</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#HPCStats.Importer.Users.UserImporterLdap.UserImporterLdap.load_groups_alias" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="HPCStats.Importer.Users.UserImporterLdap.UserImporterLdap.load_ldap">
<code class="descname">load_ldap</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#HPCStats.Importer.Users.UserImporterLdap.UserImporterLdap.load_ldap" title="Permalink to this definition">¶</a></dt>
<dd><p>Load (User,Account) tuples from LDAP directory.</p>
</dd></dl>

<dl class="method">
<dt id="HPCStats.Importer.Users.UserImporterLdap.UserImporterLdap.update">
<code class="descname">update</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#HPCStats.Importer.Users.UserImporterLdap.UserImporterLdap.update" title="Permalink to this definition">¶</a></dt>
<dd><p>Update Users and Accounts in DB based on what has been loaded from
LDAP directory and current DB content.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-HPCStats.Importer.Users.UserImporterLdapSlurm">
<span id="userimporterldapslurm-module"></span><h2><code class="xref py py-mod docutils literal"><span class="pre">UserImporterLdapSlurm</span></code> Module<a class="headerlink" href="#module-HPCStats.Importer.Users.UserImporterLdapSlurm" title="Permalink to this headline">¶</a></h2>
<p>This module contains the UserImporterLdapSlurm class.</p>
<dl class="class">
<dt id="HPCStats.Importer.Users.UserImporterLdapSlurm.UserImporterLdapSlurm">
<em class="property">class </em><code class="descclassname">HPCStats.Importer.Users.UserImporterLdapSlurm.</code><code class="descname">UserImporterLdapSlurm</code><span class="sig-paren">(</span><em>app</em>, <em>db</em>, <em>config</em>, <em>cluster</em><span class="sig-paren">)</span><a class="headerlink" href="#HPCStats.Importer.Users.UserImporterLdapSlurm.UserImporterLdapSlurm" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#HPCStats.Importer.Users.UserImporterLdap.UserImporterLdap" title="HPCStats.Importer.Users.UserImporterLdap.UserImporterLdap"><code class="xref py py-class docutils literal"><span class="pre">HPCStats.Importer.Users.UserImporterLdap.UserImporterLdap</span></code></a></p>
<p>This class inherits from UserImporterLdap so it imports users from LDAP
directory and ensure that accounts from DB are closed properly as well.
But it also imports the list of users known in Slurm DB and tries to get
information about them in LDAP. This is particularly usefull for users
that are still in LDAP but not in cluster user group anymore since these
users have not been imported by UserImporterLdap on purpose.</p>
<dl class="method">
<dt id="HPCStats.Importer.Users.UserImporterLdapSlurm.UserImporterLdapSlurm.connect_db">
<code class="descname">connect_db</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#HPCStats.Importer.Users.UserImporterLdapSlurm.UserImporterLdapSlurm.connect_db" title="Permalink to this definition">¶</a></dt>
<dd><p>Connect to cluster Slurm database and set conn/cur attribute
accordingly. Raises HPCStatsSourceError in case of problem.</p>
</dd></dl>

<dl class="method">
<dt id="HPCStats.Importer.Users.UserImporterLdapSlurm.UserImporterLdapSlurm.disconnect_db">
<code class="descname">disconnect_db</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#HPCStats.Importer.Users.UserImporterLdapSlurm.UserImporterLdapSlurm.disconnect_db" title="Permalink to this definition">¶</a></dt>
<dd><p>Disconnect from cluster Slurm database.</p>
</dd></dl>

<dl class="method">
<dt id="HPCStats.Importer.Users.UserImporterLdapSlurm.UserImporterLdapSlurm.load">
<code class="descname">load</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#HPCStats.Importer.Users.UserImporterLdapSlurm.UserImporterLdapSlurm.load" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="HPCStats.Importer.Users.UserImporterLdapSlurm.UserImporterLdapSlurm.load_slurm_users">
<code class="descname">load_slurm_users</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#HPCStats.Importer.Users.UserImporterLdapSlurm.UserImporterLdapSlurm.load_slurm_users" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="HPCStats.Importer.Users.UserImporterLdapSlurm.UserImporterLdapSlurm.update">
<code class="descname">update</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#HPCStats.Importer.Users.UserImporterLdapSlurm.UserImporterLdapSlurm.update" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="HPCStats.Log.html" class="btn btn-neutral float-right" title="Log Package" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="HPCStats.Importer.Projects.html" class="btn btn-neutral" title="Projects Package" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2015-2018, EDF CCN-HPC.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'1.6.1',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>